<!-- 声明文档类型为HTML5 -->
<!DOCTYPE html>
<!-- 定义HTML文档，并设置语言为简体中文 -->
<html lang="zh-CN">

<head>
    <!-- 设置文档字符编码为UTF-8，支持中文显示 -->
    <meta charset="UTF-8">
    <!-- 设置viewport以优化移动端显示 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 网页标题 -->
    <title>AI 便签画布</title>
    <!-- 引入外部CSS样式文件，更新为模块化CSS -->
    <link rel="stylesheet" href="css/main.css">
    <!-- 添加 marked.js 库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked@3.0.8/marked.min.js"></script>
    <!-- 添加 highlight.js 用于代码高亮（可选） -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.3.1/styles/github.min.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.3.1/highlight.min.js"></script>
</head>

<body>
    <!-- 主容器 -->
    <div class="container">
        <!-- 画布容器区域 -->
        <div class="canvas-container">
            <!-- 便签展示的画布区域 -->
            <div id="note-canvas">
                <!-- 背景元素将通过JS动态添加 -->
            </div>
        </div>

        <!-- 底部控制栏 -->
        <div class="bottom-bar">
            <!-- 输入区域 -->
            <div class="input-container">
                <textarea id="ai-prompt" placeholder="请输入文本"></textarea>
            </div>

            <!-- 底部操作区域 -->
            <div class="bottom-actions">
                <!-- 左侧功能区域 -->
                <div class="bottom-left-actions">
                    <!-- AI模型标识 -->
                    <div class="ai-model">deepseek-chat</div>
                    <!-- 删除设置按钮 -->
                </div>

                <!-- 操作按钮区域 -->
                <div class="action-buttons">
                    <button id="add-note" class="add-button">添加便笺</button>
                    <button id="ai-generate" class="ai-button">AI生成便笺</button>
                </div>
            </div>
        </div>

        <!-- 设置弹窗 -->
        <div class="settings-modal" id="settings-modal">
            <div class="settings-container">
                <div class="settings-header">
                    <h2>设置</h2>
                    <button class="close-settings circle-button" id="close-settings">&times;</button>
                </div>

                <div class="settings-content">
                    <!-- 左侧导航 -->
                    <div class="settings-nav">
                        <button class="nav-item active" data-tab="general">通用</button>
                        <button class="nav-item" data-tab="ai">AI 设置</button>
                        <button class="nav-item" data-tab="appearance">外观</button>
                        <button class="nav-item" data-tab="backup">备份恢复</button>
                        <button class="nav-item" data-tab="about">关于</button>
                    </div>

                    <!-- 右侧设置项 -->
                    <div class="settings-panels">
                        <!-- 通用设置 -->
                        <div class="settings-panel active" id="general-panel">
                            <h3>通用设置</h3>
                            <div class="setting-item">
                                <div class="setting-label">
                                    <label for="auto-save">自动保存间隔</label>
                                    <span class="setting-description">便签内容自动保存的时间间隔</span>
                                </div>
                                <div class="setting-control">
                                    <select id="auto-save">
                                        <option value="5000">5 秒</option>
                                        <option value="10000" selected>10 秒</option>
                                        <option value="30000">30 秒</option>
                                        <option value="60000">1 分钟</option>
                                    </select>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-label">
                                    <label for="default-color">默认便签颜色</label>
                                    <span class="setting-description">新便签的默认颜色</span>
                                </div>
                                <div class="setting-control color-options">
                                    <button class="color-option note-yellow active"></button>
                                    <button class="color-option note-blue"></button>
                                    <button class="color-option note-green"></button>
                                    <button class="color-option note-pink"></button>
                                    <button class="color-option note-purple"></button>
                                </div>
                            </div>
                        </div>

                        <!-- AI设置 -->
                        <div class="settings-panel" id="ai-panel">
                            <h3>AI 生成设置</h3>
                            <div class="ai-settings-container">
                                <div class="ai-settings-group">
                                    <h4>API 连接配置</h4>
                                    <div class="ai-settings-row">
                                        <div class="ai-settings-label">API 密钥</div>
                                        <div class="ai-settings-input api-key-container">
                                            <input type="text" id="ai-api-key" placeholder="输入您的 API 密钥">
                                            <button type="button" id="toggle-api-key" class="toggle-visibility"
                                                title="显示/隐藏密钥">
                                                <span class="eye-icon">👁️</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="ai-settings-description">您的 API 密钥将安全地存储在服务器端</div>

                                    <div class="ai-settings-row">
                                        <div class="ai-settings-label">基础 URL</div>
                                        <div class="ai-settings-input">
                                            <input type="text" id="ai-base-url" placeholder="https://api.openai.com/v1">
                                        </div>
                                    </div>
                                    <div class="ai-settings-description">API 服务的基础 URL 地址</div>
                                </div>

                                <div class="ai-settings-group">
                                    <h4>模型参数设置</h4>
                                    <div class="ai-settings-row">
                                        <div class="ai-settings-label">AI 模型</div>
                                        <div class="ai-settings-input">
                                            <input type="text" id="ai-model"
                                                placeholder="例如: gpt-3.5-turbo, gpt-4, claude-2"
                                                list="model-suggestions">
                                            <datalist id="model-suggestions">
                                                <option value="gpt-3.5-turbo">
                                                <option value="gpt-4">
                                                <option value="gpt-4-turbo">
                                                <option value="deepseek-chat">
                                                <option value="claude-2">
                                                <option value="claude-instant">
                                            </datalist>
                                        </div>
                                    </div>

                                    <div class="ai-settings-row">
                                        <div class="ai-settings-label">最大令牌数</div>
                                        <div class="ai-settings-input">
                                            <input type="number" id="ai-max-tokens" min="100" max="4000" step="50"
                                                value="800">
                                        </div>
                                    </div>
                                    <div class="ai-settings-description">控制生成文本的最大长度</div>

                                    <div class="ai-settings-row">
                                        <div class="ai-settings-label">温度值</div>
                                        <div class="ai-settings-input">
                                            <input type="number" id="ai-temperature" min="0" max="2" step="0.1"
                                                value="0.7">
                                        </div>
                                    </div>
                                    <div class="ai-settings-description">较低的值使输出更确定，较高的值使输出更随机创意</div>
                                </div>

                                <div class="ai-connection-test">
                                    <button id="test-ai-connection" class="ai-test-button">测试 API 连接</button>
                                    <div id="connection-status" class="ai-test-status" style="display: none;"></div>
                                    <button id="clear-ai-settings" class="ai-clear-button">清除 AI 设置</button>
                                </div>
                            </div>
                        </div>

                        <!-- 外观设置 -->
                        <div class="settings-panel" id="appearance-panel">
                            <h3>外观设置</h3>
                            <div class="setting-item">
                                <div class="setting-label">
                                    <label>主题</label>
                                    <span class="setting-description">选择应用的主题</span>
                                </div>
                                <div class="setting-control theme-options">
                                    <button class="theme-option light active">
                                        <div class="theme-preview light-preview"></div>
                                        <span>浅色</span>
                                    </button>
                                    <button class="theme-option dark">
                                        <div class="theme-preview dark-preview"></div>
                                        <span>深色
                                    </button>
                                    <button class="theme-option system">
                                        <div class="theme-preview system-preview"></div>
                                        <span>跟随系统</span>
                                    </button>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-label">
                                    <label for="font-size">字体大小</label>
                                    <span class="setting-description">便签内容的字体大小</span>
                                </div>
                                <div class="setting-control range-container">
                                    <input type="range" id="font-size" min="12" max="20" step="1" value="14">
                                    <span class="range-value">14px</span>
                                </div>
                            </div>
                        </div>

                        <!-- 备份恢复 -->
                        <div class="settings-panel" id="backup-panel">
                            <h3>备份与恢复</h3>
                            <div class="setting-item">
                                <div class="setting-label">
                                    <label>导出数据</label>
                                    <span class="setting-description">将便签数据导出为JSON文件</span>
                                </div>
                                <div class="setting-control">
                                    <button class="action-button export-button">导出数据</button>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-label">
                                    <label>导入数据</label>
                                    <span class="setting-description">从JSON文件导入便签数据</span>
                                </div>
                                <div class="setting-control">
                                    <label for="import-file" class="file-input-label">选择文件</label>
                                    <input type="file" id="import-file" accept=".json" class="file-input">
                                </div>
                            </div>
                        </div>

                        <!-- 关于 -->
                        <div class="settings-panel" id="about-panel">
                            <h3>关于</h3>
                            <div class="about-content">
                                <img src="img/logo.png" alt="Logo" class="app-logo">
                                <h2>AI 便签画布</h2>
                                <p class="version">版本 1.0.0</p>
                                <p class="description">
                                    这是一个基于 Node.js 的 Web 应用项目，允许用户创建、编辑和管理便签，
                                    并且支持使用 AI 生成便签内容。
                                </p>
                                <div class="links">
                                    <a href="https://github.com/yourusername/ai-note-canvas" target="_blank">GitHub</a>
                                    <a href="#" target="_blank">反馈问题</a>
                                    <a href="#" target="_blank">帮助文档</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-footer">
                    <button class="reset-button">重置所有设置</button>
                    <button class="save-button">保存设置</button>
                </div>
            </div>
        </div>

        <!-- 引入JavaScript文件 -->
        <!-- 便签相关功能脚本 -->
        <script src="js/note.js"></script>
        <!-- 画布相关功能脚本 -->
        <script src="js/canvas.js"></script>
        <!-- 主应用程序脚本 -->
        <script src="js/app.js"></script>
    </div>
</body>

</html>